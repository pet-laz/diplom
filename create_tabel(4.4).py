from openpyxl import Workbook

# Создаем новую рабочую книгу
wb = Workbook()
ws = wb.active
ws.title = "Экономика проекта"

# Заголовки
headers = ["№", "Статьи", "Формулы / Примечания", "Итого за период"] + [str(i) for i in range(1, 13)]
ws.append(headers)

# Данные таблицы на основе диалога (примерные значения)
rows = [
    [None, "Ставка дисконтирования (E): 0,18", "ЧДД = 2 553 тыс. руб.; ИД = 24,461; ВНД = 27%; То = 8 мес.", "", "", "", "", "", "", "", "", "", "", ""],
    
    [1, "План доходов", "", "", "", "", "", "", "", "", "", "", "", ""],
    [2, "Внешние инвестиции", "Разовая инвестиция", "1 200 000", "1 200 000"] + [""]*11,
    [3, "Количество продаж", "Прогноз", "97", 0, 0, 0, 0, 0, 10, 14, 18, 19, 19, 17],
    [4, "Цена подписки", "27 000 тенге", "", 0, 0, 0, 0, 0, 27000, 27000, 27000, 27000, 27000, 27000],
    [5, "Выручка (КП × Ц)", "", "2 619 000", 0, 0, 0, 0, 0, 270000, 378000, 486000, 513000, 513000, 459000],
    [6, "Выручка накапливающим итогом", "dn = cn + d(n–1)", "2 619 000", 0, 0, 0, 0, 0, 270000, 648000, 1134000, 1647000, 2160000, 2619000],
    [7, "Приведённая выручка", "f = d × Кд", "2 619 000", 0, 0, 0, 0, 0, 270000, 648000, 1134000, 1647000, 2160000, 2619000],
    [8, "Итого доходов", "g = z + c", "3 819 000", 1_200_000, 0, 0, 0, 0, 270000, 648000, 1134000, 1647000, 2160000, 2619000],
    [9, "Поток доходов", "h = g × Кд", "3 819 000", 1_200_000, 0, 0, 0, 0, 270000, 648000, 1134000, 1647000, 2160000, 2619000],

    [10, "План расходов", "", "", "", "", "", "", "", "", "", "", "", ""],
    [11, "Инвестиционные затраты", "Зарплата, оборудование, сервер", "1 200 000", 200000, 200000, 200000, 200000, 200000, 200000, 0, 0, 0, 0, 0],
    [12, "Эксплуатационные затраты", "подписки, сопровождение", "78 000", 0, 0, 0, 0, 0, 0, 6500, 6500, 6500, 6500, 6500],
    [13, "Итого затрат", "l = i + k", "1 278 000", 200000, 200000, 200000, 200000, 200000, 200000, 6500, 6500, 6500, 6500, 6500],
    [14, "Приведённые затраты", "o = l × Кд", "1 278 000", 200000, 200000, 200000, 200000, 200000, 200000, 6500, 6500, 6500, 6500, 6500],

    [15, "Баланс доходов и расходов", "un = hn - tn + u(n-1)", "2 541 000", 1_000_000, -200000, -200000, -200000, -200000, 70000, 641500, 1127500, 1645000, 2155000, 2614000],
    [16, "Чистый поток прибыли", "ЧДД = f - p", "2 553 000", 1_000_000, -200000, -200000, -200000, -200000, 70000, 641500, 1127500, 1645000, 2155000, 2614000]
]

# Добавляем строки в лист
for row in rows:
    ws.append(row)

# Сохраняем файл
wb.save("экономика_проекта.xlsx")
